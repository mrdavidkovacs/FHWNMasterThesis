%!TEX root = ../main.tex

\newcommand{\indicesCaption}[1]{Indices of #1 within the evaluation time frame}
\newcommand{\resultsCaption}[1]{Summarized and normalized sentiment values of #1 within the evaluation time frame}
\newcommand{\tweetsCaption}[1]{Collection time frames of tweets for #1}
\newcommand{\confusionCaption}[1]{Confusion matrix of classifier #1}

This chapter describes the performed analysis steps and discusses its results.
First, the final dataset is described in \cref{s:analysis-datasets}.
Second, the best hyper-parameters for each classifier are depicted in \cref{s:analysis-pipelines}.
Third, the sentiments time series per company are discussed in \cref{s:analysis-sentiments}.
Last but not least, the various time series are compared to the corresponding share price time series in \cref{s:analysis-granger}.

\section{Datasets}
\label{s:analysis-datasets}
% dataset description
%  - per company
%  - time series

This section describes the captured data sets in detail.
It will include both the captured indices and also captured tweets.
Furthermore, the description is divided by the owning company.

\subsection{\ford}
\label{ss:analysis-datasets-ford}

% From         To Days  Tweets
% DG#0  2018-02-28 2018-04-13   45 1536477
% DG#3  2018-06-26 2018-08-01   37 1544756
% DG#4  2018-08-20 2018-09-05   17  664214
% Total 2018-02-28 2018-09-05   99 3745447

For the \ford\ \num{3745447} english tweets have been captured in total between \printdate{2018-02-28} and \printdate{2018-09-05}.
But as stated earlier in \cref{ss:casestudy-gatherdata-tweets} this was not a continuous time frame.
The various collected time frames, number of consecutive days in each frame and collected tweets in that frame are depicted in \cref{tab:anaylsis-datasets-ford}.

\begin{table}[hbt]
    \centering
    \begin{tabular}{!>{\bfseries}l ^l ^l ^r ^r}
      \hline
      \rowstyle{\bfseries}
                & From & To & \# Days & \# Tweets \\ \hline
        Group 1 & \printdate{2018-02-28} & \printdate{2018-04-13} &   \num{45} & \num{1536477} \\
        Group 2 & \printdate{2018-06-26} & \printdate{2018-08-01} &   \num{37} & \num{1544756} \\
        Group 3 & \printdate{2018-08-20} & \printdate{2018-09-05} &   \num{17} & \num{664214} \\ \hline
        Total   & \printdate{2018-02-28} & \printdate{2018-09-05} &   \num{99} & \num{3745447} \\ \hline
    \end{tabular}
  
    \caption{\tweetsCaption{\ford}}
    \label{tab:anaylsis-datasets-ford}
\end{table}

Therefore, share prices have been downloaded for the entire given time frame which is depicted in \cref{fig:analysis-indices-ford}.

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/indices-ford.tex}    
    \caption{\indicesCaption{\ford}}
    \label{fig:analysis-indices-ford}
\end{figure}    

\subsection{\gm}
\label{ss:analysis-datasets-gm}

% From         To Days Tweets
% DG#0  2018-06-26 2018-08-01   37 270276
% DG#1  2018-08-20 2018-09-06   18 143541
% Total 2018-06-26 2018-09-06   55 413817

For the \gm\ \num{413817} english tweets have been captured in total between \printdate{2018-06-26} and \printdate{2018-09-06}.
But as stated earlier in \cref{ss:casestudy-gatherdata-tweets} this was not a continuous time frame.
The various collected time frames, number of consecutive days in each frame and collected tweets in that frame are depicted in \cref{tab:anaylsis-datasets-gm}.

\begin{table}[hbt]
    \centering
    \begin{tabular}{!>{\bfseries}l ^l ^l ^r ^r}
      \hline
      \rowstyle{\bfseries}
                & From & To & \# Days & \# Tweets \\ \hline
        Group 1 & \printdate{2018-06-26} & \printdate{2018-08-01} &   \num{37} & \num{270276} \\
        Group 2 & \printdate{2018-08-20} & \printdate{2018-09-06} &   \num{18} & \num{143541} \\ \hline
        Total   & \printdate{2018-06-26} & \printdate{2018-09-06} &   \num{99} & \num{413817} \\ \hline
    \end{tabular}
  
    \caption{\tweetsCaption{\gm}}
    \label{tab:anaylsis-datasets-gm}
\end{table}

Therefore, share prices have been downloaded for the entire given time frame which is depicted in \cref{fig:analysis-indices-gm}.

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/indices-gm.tex}    
    \caption{\indicesCaption{\gm}}
    \label{fig:analysis-indices-gm}
\end{figure}   

\subsection{\hyundai}
\label{ss:analysis-datasets-hyundai}

% From         To Days Tweets
% DG#0  2018-02-28 2018-04-08   40 363840
% DG#4  2018-06-26 2018-08-01   37 232092
% DG#5  2018-08-20 2018-09-07   19 101289
% Total 2018-02-28 2018-09-07   96 697221

For the \hyundai\ \num{697221} english tweets have been captured in total between \printdate{2018-02-28} and \printdate{2018-09-07}.
But as stated earlier in \cref{ss:casestudy-gatherdata-tweets} this was not a continuous time frame.
The various collected time frames, number of consecutive days in each frame and collected tweets in that frame are depicted in \cref{tab:anaylsis-datasets-hyundai}.

\begin{table}[hbt]
    \centering
    \begin{tabular}{!>{\bfseries}l ^l ^l ^r ^r}
      \hline
      \rowstyle{\bfseries}
                & From & To & \# Days & \# Tweets \\ \hline
        Group 1 & \printdate{2018-02-28} & \printdate{2018-04-08} &   \num{40} & \num{363840} \\
        Group 2 & \printdate{2018-06-26} & \printdate{2018-08-01} &   \num{37} & \num{232092} \\
        Group 3 & \printdate{2018-08-20} & \printdate{2018-09-07} &   \num{19} & \num{101289} \\ \hline
        Total   & \printdate{2018-02-28} & \printdate{2018-09-07} &   \num{96} & \num{697221} \\ \hline
    \end{tabular}
  
    \caption{\tweetsCaption{\hyundai}}
    \label{tab:anaylsis-datasets-hyundai}
\end{table}

Therefore, share prices have been downloaded for the entire given time frame which is depicted in \cref{fig:analysis-indices-hyundai}.

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/indices-hyundai.tex}    
    \caption{\indicesCaption{\hyundai}}
    \label{fig:analysis-indices-hyundai}
\end{figure}   

\subsection{\toyota}
\label{ss:analysis-datasets-toyota}

% From         To Days Tweets
% DG#0  2018-06-26 2018-08-01   37 331715
% DG#1  2018-08-20 2018-09-07   19 157198
% Total 2018-06-26 2018-09-07   56 488913

For the \toyota\ \num{488913} english tweets have been captured in total between \printdate{2018-06-26} and \printdate{2018-09-07}.
But as stated earlier in \cref{ss:casestudy-gatherdata-tweets} this was not a continuous time frame.
The various collected time frames, number of consecutive days in each frame and collected tweets in that frame are depicted in \cref{tab:anaylsis-datasets-toyota}.

\begin{table}[hbt]
    \centering
    \begin{tabular}{!>{\bfseries}l ^l ^l ^r ^r}
      \hline
      \rowstyle{\bfseries}
                & From & To & \# Days & \# Tweets \\ \hline
        Group 1 & \printdate{2018-06-26} & \printdate{2018-08-01} &   \num{37} & \num{331715} \\
        Group 2 & \printdate{2018-08-20} & \printdate{2018-09-07} &   \num{19} & \num{157198} \\ \hline
        Total   & \printdate{2018-02-28} & \printdate{2018-09-07} &   \num{56} & \num{488913} \\ \hline
    \end{tabular}
  
    \caption{\tweetsCaption{\toyota}}
    \label{tab:anaylsis-datasets-toyota}
\end{table}

Therefore, share prices have been downloaded for the given time frame which is depicted in \cref{fig:analysis-indices-toyota}.

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/indices-toyota.tex}    
    \caption{\indicesCaption{\toyota}}
    \label{fig:analysis-indices-toyota}
\end{figure}   

\subsection{\vw}
\label{ss:analysis-datasets-vw}

%             From         To Days  Tweets
% DG#0  2018-02-28 2018-04-08   40 3001535
% DG#4  2018-06-26 2018-07-03    8  765042
% DG#5  2018-07-19 2018-08-01   14  955986
% DG#6  2018-08-20 2018-09-05   17 1496787
% Total 2018-02-28 2018-09-05   79 6219350

For the \vw\ \num{6219350} english tweets have been captured in total between \printdate{2018-02-28} and \printdate{2018-09-05}.
But as stated earlier in \cref{ss:casestudy-gatherdata-tweets} this was not a continuous time frame.
The various collected time frames, number of consecutive days in each frame and collected tweets in that frame are depicted in \cref{tab:anaylsis-datasets-vw}.

\begin{table}[hbt]
    \centering
    \begin{tabular}{!>{\bfseries}l ^l ^l ^r ^r}
      \hline
      \rowstyle{\bfseries}
                & From & To & \# Days & \# Tweets \\ \hline
        Group 1 & \printdate{2018-02-28} & \printdate{2018-04-08} &   \num{40} & \num{3001535} \\
        Group 2 & \printdate{2018-06-26} & \printdate{2018-07-03} &   \num{08} & \num{765042} \\
        Group 3 & \printdate{2018-07-19} & \printdate{2018-08-01} &   \num{14} & \num{955986} \\
        Group 4 & \printdate{2018-08-20} & \printdate{2018-09-05} &   \num{17} & \num{1496787} \\ \hline
        Total   & \printdate{2018-02-28} & \printdate{2018-09-05} &   \num{96} & \num{6219350} \\ \hline
    \end{tabular}
  
    \caption{\tweetsCaption{\vw}}
    \label{tab:anaylsis-datasets-vw}
\end{table}

Therefore, share prices have been downloaded for the given time frame which is depicted in \cref{fig:analysis-indices-vw}.

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/indices-vw.tex}    
    \caption{\indicesCaption{\vw}}
    \label{fig:analysis-indices-vw}
\end{figure}   

\section{Hyper-parameters}
\label{s:analysis-pipelines}
% best estimator pipeline

This section presents the results of the model selector GridSearchCV as described in \cref{s:casestudy-sentiment}.
GridSearchCV has been trained and tested using the Twitter corpus of \ac{NLTK} (\emph{nltk.corpus.twitter\_samples}).

\subsection{TextBlob Classifier}
\label{ss:analysis-pipeline-textblob}

As previously stated \emph{TextBlob} is a pre-trained classifier which works out-of-the-box.
It can be seen as kind of a base-line.

As the TextBlob classifies text on a continuous scale between \texttt{-1} and \texttt{1} it also includes the possibility of a neutral sentiment: \texttt{0}.
In order to compare this classifier with the other tested ones we have to generalize the results of TextBlob using the following cases in \cref{eq:analysis-pipeline-textblob}.

\begin{equation}
Sentiment_{generalized} = 
    \begin{cases}
    1,  & Sentiment_{TextBlob} \geq 0 \\
    -1  & \text{otherwise}
    \end{cases}
    \label{eq:analysis-pipeline-textblob}
\end{equation}

These adjustments lead finally to an accuracy of \SI{97.34}{\percent} and an F-Measure of \num{97.37}.
The confusion matrix is depicted in \cref{tab:anaylsis-pipeline-textblob-confusion}.

% Accuracy: 97.34%
% F1 Score: 97.37
% Confusion Matrix:
%  [[4814  186]
%  [  80 4920]]

\begin{table}[hbt]
    \centering
    \begin{tabular}{!>{\bfseries}l ^r ^r}
      \hline
      \rowstyle{\bfseries}
        & \multicolumn{2}{c}{Correct labels} \\
        \rowstyle{\bfseries}
        Predicted labels & Positive & Negative \\ \hline
        Positive & \num{4920}    & \num{186}  \\
        Negative & \num{80}      & \num{4814} \\ \hline
    \end{tabular}
  
    \caption{\confusionCaption{TextBlob}}
    \label{tab:anaylsis-pipeline-textblob-confusion}
\end{table}


\section{Sentiment Time Series}
\label{s:analysis-sentiments}
% depict time series

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/results-ford.tex}    
    \caption{\resultsCaption{\ford}}
    \label{fig:analysis-results-ford}
\end{figure} 

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/results-gm.tex}    
    \caption{\resultsCaption{\gm}}
    \label{fig:analysis-results-gm}
\end{figure} 

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/results-hyundai.tex}    
    \caption{\resultsCaption{\hyundai}}
    \label{fig:analysis-results-hyundai}
\end{figure} 

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/results-toyota.tex}    
    \caption{\resultsCaption{\toyota}}
    \label{fig:analysis-results-toyota}
\end{figure} 

\begin{figure}[hbt]
    \centering
    \input{./images/graphs/results-vw.tex}    
    \caption{\resultsCaption{\vw}}
    \label{fig:analysis-results-vw}
\end{figure} 

\section{Comparison of Time Series}
\label{s:analysis-granger}
% granger causality

